from Baum_Welch import forward_descaled, run_baum_welch, forward_first

'''
A = [[0.0, 0.8, 0.1, 0.1], [0.1, 0.0, 0.8, 0.1],
     [0.1, 0.1, 0.0, 0.8], [0.8, 0.1, 0.1, 0.0]]
B = [[0.9, 0.1, 0.0, 0.0], [0.0, 0.9, 0.1, 0.0],
     [0.0, 0.0, 0.9, 0.1], [0.1, 0.0, 0.0, 0.9]]
q = [1.0, 0.0, 0.0, 0.0]
seq = [0, 1, 2, 3, 0, 1, 2, 3]

print(forward_descaled(A, 4, 4, B, 4, 4, q, 4, seq, 8))
'''
'''
A = [[0.3, 0.7], [0.1, 0.9]]
B = [[0.4, 0.6], [0.5, 0.5]]
q = [0.85, 0.15]
seq = [0, 1, 1, 0]
A_new, B_new, q_new = run_baum_welch(A, 2, 2, B, 2, 2, q, 2, seq, 4, 10000)
print(A_new)
'''
#A= [[0.4, 0.2, 0.2,0.2],[0.2,0.4,0.2,0.2],[0.2,0.2,0.4,0.2],[0.2,0.2,0.2,0.4]]
# B=[[0.4,0.2,0.2,0.2],[0.2,0.4,0.2,0.2],[0.2,0.2,0.4,0.2],[0.2,0.2,0.2,0.4]]
# q=[0.241896,0.266086,0.249153,0.242864]
# seq=[0,1,2,3,3,0,0,1,1,1,2,2,2,3,0,0,0,1,1,1,2,3,3,0,0,0,1,1,1,2,3,3,0,1,2,3,0,1,1,1,2,3,3,0,1,2,2,3,0,0,0,1,1,2,2,3,0,1,1,2,3,0,1,2,2,2,2,3,0,0,1,2,3,0,1,1,2,3,3,3,0,0,1,1,1,1,2,2,3,3,3,0,1,2,3,3,3,3,0,1,1,2,2,3,0,0,0,0,0,0,0,0,0,1,1,1,1,1,2,2,2,3,3,3,3,0,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,0,1,2,3,0,1,1,1,2,3,0,1,1,2,2,2,2,2,3,0,1,1,1,2,2,2,2,3,0,0,0,0,0,1,1,1,1,2,2,3,3,0,1,2,3,3,0,0,0,0,0,0,1,1,2,2,3,0,0,1,1,1,1,1,1,2,3,3,0,0,1,1,1,2,3,0,0,1,2,3,0,1,1,2,3,3,0,0,0,1,2,3,3,3,0,1,1,1,1,2,3,3,3,3,3,3,0,1,2,2,2,2,2,2,3,0,1,1,1,2,2,3,3,3,3,0,1,2,3,0,0,0,1,1,2,2,3,0,0,0,0,0,0,0,1,2,2,2,3,3,3,3,0,0,1,2,2,2,3,3,3,0,0,1,2,2,3,0,0,0,0,1,1,1,2,3,3,3,3,3,3,3,3,0,1,2,3,0,0,1,2,3,3,3,0,0,0,0,0,1,1,1,1,2,3,0,0,0,1,2,2,3,3,0,0,0,1,1,1,1,1,2,3,3,3,3,0,1,1,1,2,2,3,0,1,2,3,3,3,3,0,0,0,0,1,2,3,3,0,1,2,2,3,3,0,0,1,1,2,3,3,0,1,2,2,3,3,3,0,0,1,1,2,3,3,3,3,0,0,1,1,2,3,3,0,1,2,3,0,1,1,2,2,3,0,1,2,3,3,0,1,1,1,2,2,2,3,3,0,0,1,1,1,1,1,2,3,3,3,0,1,1,2,2,2,2,3,3,0,0,1,2,3,0,1,1,2,2,2,2,3,0,0,1,2,2,3,0,0,0,0,0,1,1,1,2,3,0,0,1,2,3,3,0,0,0,1,2,2,2,3,3,0,0,0,1,2,2,2,2,2,3,0,1,1,2,3,0,0,1,1,1,2,2,3,0,0,0,0,1,1,1,2,2,3,0,1,1,1,2,2,2,3,3,0,0,1,2,2,3,3,3,0,1,1,2,3,0,0,0,0,0,1,2,2,2,3,3,3,0,0,0,1,2,3,0,1,1,2,3,3,3,0,1,2,2,2,3,0,0,1,1,1,1,2,3,3,0,0,0,0,1,2,3,3,3,0,0,0,1,1,2,3,0,1,1,1,1,2,2,2,2,2,2,3,0,0,0,0,1,2,2,2,2,3,0,1,2,2,3,0,1,2,3,0,1,2,3,0,0,0,1,1,2,2,3,3,0,1,1,1,1,2,2,3,3,0,1,1,1,2,2,2,3,3,3,0,1,1,2,3,3,0,1,2,3,0,0,0,0,1,2,3,0,0,0,0,0,0,1,2,2,3,3,0,0,1,2,3,0,1,2,2,3,0,0,0,1,1,2,2,2,2,2,3,3,3,3,3,0,1,2,2,3,3,3,3,3,0,0,1,1,2,2,3,0,0,1,2,2,3,3,3,0,0,0,1,2,2,2,2,3,3,0,1,2,3,0,0,1,1,1,2,2,3,0,0,1,1,2,2,2,3,3,0,0,1,1,1,1,1,2,3,3,3,0,1,2,2,2,2,3,3,3,3,3,3,0,0,0,0,0,0,1,2,3,0,0,1,1,1,2,3,0,0,1,1,2,2,2,2,3,3,3,0,1,1,2,2,2,3,3,0,0,0,0,0,0,1,2,2,3,3,0,0,0,0,0,0,1,2,3,3,3,0,1,1,1,2,2,2,2,2,3,3,3,0,1,2,2,2,3,3,3,3,0,0,0,0,1,2,3,3,3,3,3,3,0,0,1,1,1,1,2,3,0,1,2,3,0,1,1,2,3,3,3,0,0,0,0,1,1,2,3,3,3,3,0,0,1,1,1,2,2,2,2,2,2,3,3,0,0,0,1,2,3,0,0,1,1,2,2,3,3,3,3,3,0,0,1,2,2,2,2,3,0,0,1,1,1,1,1,2,3,3,0,0,1,1,1,2,3,3,3,0,0]
#A_new, B_new, q_new = run_baum_welch(A, 4, 4, B, 4, 4, q, 4, seq, 1000, 10000)
# print(A_new)

#A = [[] for j in range(2)]
# B = [[0.4, 0.2, 0.2, 0.2], [0.2, 0.4, 0.2, 0.2],
#     [0.2, 0.2, 0.4, 0.2], [0.2, 0.2, 0.2, 0.4]]
# B2 = [[0.4, 0.2, 0.2, 0.2], [0.2, 0.4, 0.2, 0.2],
#      [0.2, 0.2, 0.4, 0.2], [0.2, 0.2, 0.2, 0.4]]
#B3 = [0.4, 0.2, 0.4, 0.6]
#C = [B, B2, B3]
# A[0].append(C)


# print(A[0][len(A[0])-1][0])  # Access fish species
# print(A[0][len(A[0])-1][0])   # A matrix

'''
A = [[0.6, 0.1, 0.1, 0.2], [0.0, 0.3, 0.2, 0.5],
     [0.8, 0.1, 0.0, 0.1], [0.2, 0.0, 0.1, 0.7]]
B = [[0.6, 0.2, 0.1, 0.1], [0.1, 0.4, 0.1, 0.4],
     [0.0, 0.0, 0.7, 0.3], [0.0, 0.0, 0.1, 0.9]]
q = [0.4, 0.2, 0.1, 0.3]

print(forward_first(A, 4, 4, B, 4, 4, q, 4))
'''
q = [0.14, 0.15, 0.135, 0.1315, 0.16, 0.13, 0.1535]
A = [[0.15, 0.1535, 0.16, 0.14, 0.135, 0.13, 0.1315], [0.14, 0.16, 0.1315, 0.15, 0.13, 0.135, 0.1535], [0.14, 0.1315, 0.135, 0.15, 0.1535, 0.16, 0.13], [0.15, 0.13, 0.16, 0.1315, 0.1535, 0.14, 0.135],
     [0.15, 0.1315, 0.14, 0.135, 0.16, 0.1535, 0.13], [0.13, 0.1315, 0.15, 0.1535, 0.14, 0.16, 0.135], [0.14, 0.1315, 0.135, 0.15, 0.13, 0.16, 0.1535]]
B = [[0.125, 0.120, 0.115, 0.130, 0.135, 0.1225, 0.1225, 0.130], [0.115, 0.125, 0.1225, 0.12, 0.135, 0.13, 0.13, 0.1225], [0.1225, 0.1225, 0.13, 0.115, 0.13, 0.12, 0.135, 0.125], [0.115, 0.13, 0.125, 0.1225, 0.135, 0.1225, 0.13, 0.12],
     [0.13, 0.125, 0.115, 0.12, 0.1225, 0.13, 0.135, 0.1225], [0.125, 0.13, 0.1225, 0.135, 0.13, 0.12, 0.1225, 0.115], [0.115, 0.13, 0.12, 0.1225, 0.1225, 0.13, 0.125, 0.135]]
seq = [6, 3, 7, 2, 5, 7, 2]

A_new, B_new, q_new = run_baum_welch(
    A, 7, 7, B, 7, 8, q, 7, seq, len(seq), 100)
print(A_new)
